{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>ResPax Test Tool</title>

    <link rel="stylesheet" href={% static "css/bootstrap.min.css" %}>
    <link rel="stylesheet" href={% static "css/bootstrap-table-expandable.css" %}>

    <script src={% static "js/jquery-2.1.4.min.js" %}></script>
    <script src={% static "js/collapsibleTable.js" %}></script>

</head>
<body>
<!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">ResPax</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active"><a href="/testTool/">Home</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                       aria-expanded="false">Dropdown <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#">Action</a></li>
                        <li><a href="#">Another action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">Nav header</li>
                        <li><a href="#">Separated link</a></li>
                        <li><a href="#">One more separated link</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/logout/">Log out <span class="sr-only">(current)</span></a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<div class="container">
    <h1 style="margin-top:150px;">ResPax Test Tool</h1>
    <table id="test-tool-table" class="table table-hover table-expandable table-striped">
        <thead>
        <tr>
            <th colspan="3">Operator</th>
            <th colspan="3">Location</th>
        </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
</div>
</body>
</html>

<script type="text/javascript">
    //var host_name = [];
    //var location = [];
    function generateTable(operators, locations, host_id, code, basis, subbasis, time, pickup_id) {

        for (var i = 0; i in operators; i++) {
            var tableRow = document.createElement('tr');
            var tableRow2 = document.createElement('tr');
            var table = document.getElementById("test-tool-table").getElementsByTagName('tbody')[0];
            var operator_td = document.createElement("td");
            var location_td = document.createElement("td");

            var code_td = document.createElement("td");
            var basis_td = document.createElement("td");
            var subbasis_td = document.createElement("td");
            var time_td = document.createElement("td");
            var pickup_id_td = document.createElement("td");

            var operator_td_value = document.createTextNode(operators[i] + ' (' + host_id[i] + ')');
            var location_td_value = document.createTextNode(locations[i]);

            var code_td_value = document.createTextNode(code[i]);
            var basis_td_value = document.createTextNode("Basis: " + basis[i]);
            var subbasis_td_value = document.createTextNode("Subbasis: " + subbasis[i]);
            var time_td_value = document.createTextNode("Time: " + time[i]);
            var pickup_id_td_value = document.createTextNode("Pickup ID: " + pickup_id[i]);

            operator_td.appendChild(operator_td_value);
            location_td.appendChild(location_td_value);

            code_td.appendChild(code_td_value);
            basis_td.appendChild(basis_td_value);
            subbasis_td.appendChild(subbasis_td_value);
            time_td.appendChild(time_td_value);
            pickup_id_td.appendChild(pickup_id_td_value);

            operator_td.setAttribute("colspan", "3");
            operator_td.setAttribute("onclick", "getTours()");
            location_td.setAttribute("colspan", "3");

            tableRow.setAttribute("id", "1");
            tableRow.setAttribute("data-level", "1");

            tableRow2.setAttribute("id", "2");
            tableRow2.setAttribute("data-level", "2");
            tableRow2.setAttribute("type", "checkbox");

            tableRow.appendChild(operator_td);
            tableRow.appendChild(location_td);

            tableRow2.appendChild(code_td);
            tableRow2.appendChild(basis_td);
            tableRow2.appendChild(subbasis_td);
            tableRow2.appendChild(time_td);
            tableRow2.appendChild(pickup_id_td);

            table.appendChild(tableRow);
            table.appendChild(tableRow2);
        }

    }

    var host_name = {{ host_name|safe }};
    var locations = {{ locations|safe }};
    var host_id = {{ host_id|safe }};
    var code = '';
    var basis = {{ basis|safe }};
    var subbasis = {{ subbasis|safe }};
    var time = {{ time|safe }};
    var pickup_id = {{ pickup_id|safe }};


    generateTable(host_name, locations, host_id, code, basis, subbasis, time, pickup_id);

    function getTours() {
        /*
        console.log('executed');
        $.ajax({
            type:'POST',
            url: '/get_tours/',
            dataType: 'json',
            async: true,

            data: {
                safe: false,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },

            success: function(json) {
                console.log(json);
                console.log(json.strTourCode);
            }
        })*/


    }

</script>